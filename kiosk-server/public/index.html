<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Kiosk Admin</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="kiosk-container">
        <header class="kiosk-header">
            <h1 id="kiosk-title">Kiosk Admin</h1>
            <div id="current-time" class="time-display"></div>
        </header>
        
        <main class="kiosk-content">
            <div id="control-panel" class="content-panel">
                <h2>Control Panel</h2>
                <div class="admin-row">
                    <input id="admin-url" type="text" placeholder="Enter a URL to display" />
                    <button id="btn-apply-url">Switch URL</button>
                </div>

            <div class="content-panel" id="hb-panel">
                <div class="panel-header">
                    <h2>Heartbeat Clients</h2>
                    <div class="panel-actions">
                        <button id="btn-refresh-hb">Refresh</button>
                    </div>
                </div>
                <div class="admin-row" style="display:flex; gap:0.5rem; flex-wrap:wrap; align-items:center;">
                    <input id="hb-target" type="text" placeholder="Target key (id or IP)" style="min-width:240px;" />
                    <input id="hb-cmd-type" type="text" placeholder="Command type (e.g., reboot, update)" style="min-width:220px;" />
                    <input id="hb-cmd-payload" type="text" placeholder='Payload JSON (e.g., {"url":"..."})' style="min-width:320px; flex:1;" />
                    <button id="btn-send-hb-cmd">Send Command</button>
                </div>
                <div id="hb-list" class="devices-list-container">
                    <p>No heartbeat clients yet.</p>
                </div>
                <div id="hb-result" class="info-box" style="display:none; margin-top:0.5rem;"></div>
            </div>

            <div class="content-panel" id="deploy-panel">
                <div class="panel-header">
                    <h2>Deploy to Clients</h2>
                </div>
                <div class="admin-row" style="display:flex; gap:0.5rem; flex-wrap:wrap;">
                    <input id="deploy-username" type="text" placeholder="SSH Username (e.g., student)" style="min-width:200px;" value="tahar" />
                    <input id="deploy-password" type="password" placeholder="SSH Password (optional if using key)" style="min-width:240px;" value="tahar" />
                    <input id="deploy-server-base" type="text" placeholder="Server Base (e.g., http://192.168.0.10:4000)" style="min-width:320px; flex:1;" />
                </div>
                <div class="admin-row" style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem;">
                    <textarea id="deploy-hosts" placeholder="Enter kiosk IP addresses here (one per line)." rows="3" style="width:100%;"></textarea>
                </div>
                <div class="info-note" style="margin-top: 0.25rem; font-size: 0.8rem; text-align: center;">
                    For best results, provide a specific list of kiosk IPs. Leaving this empty will scan the entire network.
                </div>
                <div class="admin-row secondary-controls" style="display:flex; gap:1rem; align-items:center; margin-top:0.5rem;">
                    <label><input type="checkbox" id="deploy-run-setup" /> Run first-time setup</label>
                    <label><input type="checkbox" id="deploy-reboot" /> Reboot after deploy</label>
                    <div class="spacer"></div>
                    <button id="btn-deploy">Deploy</button>
                </div>
                <div id="deploy-result" class="info-box" style="display:none; margin-top:1rem;"></div>
            </div>

            <div class="content-panel" id="restart-panel">
                <div class="panel-header">
                    <h2>Restart Clients</h2>
                </div>
                <div class="admin-row" style="display:flex; gap:0.5rem; flex-wrap:wrap;">
                    <input id="restart-username" type="text" placeholder="SSH Username" style="min-width:200px;" value="tahar" />
                    <input id="restart-password" type="password" placeholder="SSH Password" style="min-width:240px;" value="tahar" />
                </div>
                <div class="admin-row" style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem;">
                    <textarea id="restart-hosts" placeholder="Enter kiosk IP addresses to restart (one per line)." rows="3" style="width:100%;"></textarea>
                </div>
                <div class="info-note" style="margin-top: 0.25rem; font-size: 0.8rem; text-align: center;">
                    Leave hosts empty to restart all discovered kiosks on the network.
                </div>
                <div class="admin-row secondary-controls" style="display:flex; gap:1rem; align-items:center; margin-top:0.5rem;">
                    <div class="spacer"></div>
                    <button id="btn-restart">Restart Clients</button>
                </div>
                <div id="restart-result" class="info-box" style="display:none; margin-top:1rem;"></div>
            </div>
                <div class="admin-row secondary-controls">
                    <button id="btn-reload">Reload Frame</button>
                    <label class="switch">
                        <input type="checkbox" id="toggle-blackout" />
                        <span>Blackout</span>
                    </label>
                    <div class="spacer"></div>
                    <input id="admin-token" type="password" placeholder="Admin Token" />
                </div>
            </div>

            <div class="content-panel" id="devices-panel">
                <div class="panel-header">
                    <h2>Connected Devices</h2>
                    <button id="btn-refresh-devices">Refresh</button>
                </div>
                <div id="devices-list" class="devices-list-container">
                    <!-- Device list will be rendered here by JavaScript -->
                    <p>Loading devices...</p>
                </div>
            </div>

            <div class="content-panel" id="lan-panel">
                <div class="panel-header">
                    <h2>Network Devices</h2>
                    <div class="panel-actions">
                        <label for="scan-mode" style="margin-right:6px;">Mode</label>
                        <select id="scan-mode" style="margin-right:10px;">
                            <option value="fast" selected>Fast</option>
                            <option value="detailed">Detailed</option>
                            <option value="aggressive">Aggressive</option>
                        </select>
                        <input id="scan-subnet" type="text" placeholder="Subnet (e.g., 192.168.0.0/24)" style="min-width:220px; margin-right:8px;" />
                        <input id="scan-ports" type="text" placeholder="Ports (e.g., 22,80,443 or 1-1000)" style="min-width:220px; margin-right:8px;" />
                        <button id="btn-show-interfaces">Interfaces</button>
                        <button id="btn-scan-lan">Scan Network</button>
                    </div>
                </div>
                <div id="lan-interfaces" class="devices-list-container hidden"></div>
                <div id="lan-results" class="devices-list-container">
                    <p>Click <strong>Scan Network</strong> to discover devices on your LAN.</p>
                </div>
            </div>

            <div id="stage" class="kiosk-stage">
                <div id="preview-controls">
                    <button id="btn-open-url">Open Current URL</button>
                    <p id="current-url-display">URL not set</p>
                </div>
                <div id="blackout-overlay" class="blackout hidden"></div>
            </div>

        </main>
        
        <footer class="kiosk-footer">
            <p id="kiosk-footer"> 2023 Kiosk System</p>
        </footer>
    </div>

    <script src="/js/main.js"></script>
</body>
</html>
